<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="cs" lang="cs">
	<head>
		<script language="JavaScript" src="../../jsunit/app/jsUnitCore.js"></script>
		<script language="JavaScript" src="../../lib/jak.js"></script>
		<script language="JavaScript">
		
		function testCel() {
			var e = JAK.cEl("div","nejakeid","nejakaclasa",{fontFamily:"arial"});
			document.body.appendChild(e);
			assertEquals('cEl', e.tagName.toLowerCase(), "div");
			assertEquals('cEl id', e.id, "nejakeid");
			assertEquals('cEl class', e.className, "nejakaclasa");
			assertEquals('getStyle', JAK.DOM.getStyle(e,"fontFamily").toLowerCase(), "arial");
		}
		
		function testCtxt() {
			var t = JAK.cTxt("ahoj");
			assertEquals("cTxt nodeType", t.nodeType, 3);
			assertEquals("cTxt nodeValue", t.nodeValue, "ahoj");
		}
		
		function testClasses() {
			var d = JAK.cEl("div");
			JAK.DOM.addClass(d,"c1");
			assertEquals("addClass + hasClass", JAK.DOM.hasClass(d,"c1"), true);
			assertEquals("hasClass", JAK.DOM.hasClass(d,"c2"), false);
			JAK.DOM.removeClass(d,"c1");
			assertEquals("removeClass + hasClass", JAK.DOM.hasClass(d,"c1"), false);
		}
		
		function testGel() {
			var d = JAK.cEl("div","mujdiv");
			document.body.appendChild(d);
			assertEquals("gEl existuje #1", JAK.gEl("mujdiv"), d);
			assertEquals("gEl existuje #2", JAK.gEl(d), d);
			assertNull("gEl neexistuje", JAK.gEl("tvujdiv"));
		}
		
		function testAppendClear() {
			var p = JAK.cEl("div");
			var a = [];
			for (var i=0;i<3;i++) {
				var ch = JAK.cEl("div");
				a.push(ch);
			}
			JAK.DOM.append([p,a[0],a[1]],[a[1],a[2]]);
			assertEquals("append #1", p.childNodes.length, 2);
			assertEquals("append #2", a[2].parentNode, a[1]);
			JAK.DOM.clear(p);
			assertEquals("clear", p.childNodes.length, 0);
		}
		
		function testByClass() {
			var d = JAK.cEl("div");
			var a1 = JAK.cEl("a",false,"c");
			var a2 = JAK.cEl("a",false,"c");
			var a3 = JAK.cEl("a",false,"d");
			document.body.appendChild(a1);
			d.appendChild(a3);
			a3.appendChild(a2);
			document.body.appendChild(d);
			
			var list = JAK.DOM.getElementsByClass("c");
			assertEquals("getElementsByClassName #1", list.length, 2);
			
			var list = JAK.DOM.getElementsByClass("c",d);
			assertEquals("getElementsByClassName #2a", list.length, 1);
			assertEquals("getElementsByClassName #2b", list[0], a2);

			var list = JAK.DOM.getElementsByClass("c", false, "span");
			assertEquals("getElementsByClassName #3", list.length, 0);			
		}
		
		function testStyle() {
			var d = JAK.cEl("div");
			document.body.appendChild(d);
			JAK.DOM.setStyle(d, {marginLeft:"2px",lineHeight:"10px"} );
			assertEquals("style #1", JAK.DOM.getStyle(d,"lineHeight"), "10px");			
			assertEquals("style #1", JAK.DOM.getStyle(d,"marginLeft"), "2px");			
		}
		
		function testScroll() {
			document.documentElement.scrollTop = 0;
			var d = JAK.cEl("div",false,false,{position:"absolute",top:"0px",overflow:"scroll",height:"100px"});
			var dd1 = JAK.cEl("div",false,false,{height:"100px",width:"10px"});
			var dd2 = JAK.cEl("div",false,false,{height:"100px",width:"10px"});
			d.appendChild(dd1);
			d.appendChild(dd2);
			document.body.appendChild(d);
			d.scrollTop = 100;
			var scroll = JAK.DOM.getBoxScroll(dd2);
			assertEquals("getBoxScroll", scroll.y, 100);			
			var pos = JAK.DOM.getPortBoxPosition(dd2);
			assertEquals("getPortBoxPosition", pos.top, 0);			
		}
		
		function testPageScroll() {
			var elms = [];
			var st = 100;
			var limit = 10;
			var counter = 0;
			do {
				counter++;
				var div = JAK.cEl("div", false, false, {height:"100px"});
				elms.push(div);
				document.body.appendChild(div);
				window.scrollTo(0, st);
			} while (document.documentElement.scrollTop != st && counter < limit);
			var div = JAK.cEl("div");
			elms.push(div);
			document.body.appendChild(div);
			var pos = JAK.DOM.getBoxScroll(div);
			assertEquals("getBoxScroll", st, pos.y);
			
			for (var i=0;i<elms.length;i++) {
				elms[i].parentNode.removeChild(elms[i]);
			}
		}

		function testSeparateCode() {
			var part1 = "ahoj";
			var part2 = "<strong>neco</strong>";
			var part3 = "nazdar";
			var tmp = 0;
			
			var html = part1;
			html += "<scr" + "ipt>tmp = 6;</scr" + "ipt>";
			html += part2;
			html += "<scr" + "ipt type='text/javascript'>tmp += 7;</scr" + "ipt>";
			html += part3;
			
			var data = JAK.DOM.separateCode(html);
			assertEquals(part1+part2+part3, data[0]);
			eval(data[1]);
			assertEquals(13, tmp);
		}
		</script>
	</head>
	<body>
	</body>
</html>
