<html>
	<head>
		<script language="JavaScript" src="../../../jsunit/app/jsUnitCore.js"></script>
		<script language="JavaScript" src="../../../lib/main.js"></script>
		<script language="JavaScript" src="../../../lib/classmaker.js"></script>
		<script language="JavaScript">
			//document.write("<sc" + "ript language='JavaScript' src='/jsunit/libs/class_maker.js?'" + Math.random() + "></"  +  "script>")
			// root (pradedecek)
			var Root_ExtendClass = SZN.ClassMaker.makeClass({
				NAME:'Root_ExtendClass',
				VERSION:'1.0',
				CLASS:'class'
			});
			
			Root_ExtendClass.prototype.$constructor = function(){
				this.greatGrandFather  = 'Root_ExtendClass'
			}
			// -->
			
			// predek predka (dedecek)
			var Pre_ExtendClass = SZN.ClassMaker.makeClass({
				NAME:'Pre_ExtendClass',
				VERSION:'1.0',
				EXTEND:Root_ExtendClass,
				CLASS:'class'
			});
			
			Pre_ExtendClass.prototype.$constructor = function(){
				this.callSuper('$constructor',arguments.callee)();
				this.grandFather = 'Pre_ExtendClass'
			};
			
			Pre_ExtendClass.prototype.methodWidthParams = function(a,b){
				return a + b;
			}
			
			// -->
			
			
			// predek (primy)
			var ExtendClass = SZN.ClassMaker.makeClass({
				NAME:'ExtendClass',
				VERSION:'1.0',
				EXTEND:Pre_ExtendClass,
				CLASS:'class'
			});
			
			ExtendClass.prototype.$constructor = function(){
				this.callSuper('$constructor',arguments.callee)();
				this.father = 'ExtendClass'
			}
			
			ExtendClass.prototype.getTitle = function(){
				return this.title;
			}
			
			ExtendClass.prototype.tmpMethod = function(){
				return true;
			}			
			
			// -->

			// prvni rozhrani
			var InterfaceClass_0 = SZN.ClassMaker.makeClass({
				NAME:'InterfaceClass_0',
				VERSION:'1.0',
				CLASS:'class'
			});
			
			InterfaceClass_0.prototype.desc = 'xxx';
			InterfaceClass_0.prototype.getAttributes = function(){
				var out = {}
				for(var i in this){
					if((typeof this[i] == 'string') ||(typeof this[i] == 'number')){
						out[i] = this[i];
					} 
				}
				return out;
			}
			// -->
			
			// druhe rozhrani					
			var InterfaceClass_1 = SZN.ClassMaker.makeClass({
				NAME:'InterfaceClass_1',
				VERSION:'1.0',
				CLASS:'class'
			});
			
			InterfaceClass_1.prototype.getNameAndTitle = function(){
				var out = this.name + ' ' + this.title;
				return out;
			}			
			// -->
			
			// trida
			
			var MyClass = SZN.ClassMaker.makeClass({
				NAME:"RefClass",
				VERSION:"1.0",
				DEPEND:[{
					sClass:ExtendClass,
					ver:'1.0'
				}],
				EXTEND : ExtendClass,
				IMPLEMENT:[InterfaceClass_0,InterfaceClass_1],
				CLASS : "class"
			});
			
			MyClass.prototype.$constructor = function(name,title){
				this.callSuper('$constructor',arguments.callee)();
				this.name = name;
				this.title = title;				
			}
			
			MyClass.prototype.$destructor = function(){
				this.sConstructor.destroy(this);
			};

			MyClass.prototype.get = function(){
				return this.name;
			};
			
			MyClass.prototype.superCalling = function(methodName){
				var out = false;
				try{
					var out = this.callSuper(methodName,arguments.callee)()
				} catch(e){
					;//empty
					warn("Test selhani: " + e)
				} finally {
					return out
				}
			};

			
			
			var classDef = {
				staticData : {
					NAME:"XefClass",
					VERSION:"1.0",
					DEPEND:[{
						sClass:ExtendClass,
						ver:'1.0'
					}],
					EXTEND : ExtendClass,
					IMPLEMENT:[InterfaceClass_0,InterfaceClass_1],
					CLASS : "class",
					trg:'window'				
				},
				proto : {
					$constructor : function(name,title){
						this.callSuper('$constructor',arguments.callee)();
						this.name = name;
						this.title = title;				
					},
					$destructor : function(){
						this.sConstructor.destroy(this);
					},
					get : function(){
						return this.name;
					},
					superCalling : function(methodName){
						var out = false;
						try{
							var out = this.callSuper(methodName,arguments.callee)()
						} catch(e){
							;//empty
							warn("Test selhani: " + e)
						} finally {
							return out
						}						
					}
				},
				access : {
					get : 'public getName',
					superCalling : 'public sCl'
				}
			} 
			
			
			
			
			
			// -->

			var ref;
			var tst;
			var out = {
				title : 'refClass',
				name : 'RefClass',
				desc : 'xxx',
				father : 'ExtendClass',
				grandFather :'Pre_ExtendClass',
				greatGrandFather:'Root_ExtendClass'
			};
			function setUpPage(){
				tst = new MyClass('RefClass','refClass');
				setUpPageStatus = 'complete';	
			};
			
			function testJsonToClass(){
				inform('Vytvarim tridu z literalu pomoci jsonToClass()')
				try {
					SZN.ClassMaker.jsonToClass(classDef)
				} catch(e){
					warn('json to class: ' +  e)
				} finally {
					var a = typeof window.XefClass;
					var b = 'function'
					assertEquals('vytvoreni konstruktoru z JSON : ',a,b)
				}
			} 

			function testJsonToClassInstance(){
				inform('Vytvarim tridu z literalu pomoci jsonToClass() a zaroven jeji instanci')
				SZN.ClassMaker.jsonToClass(classDef);
				var xxx = new XefClass('RefClass','refClass');
	
				
				inform('### testovani dedeni z vice rozhrani pro tridy vytvorenou z literalu ###')
				var str = 'RefClass refClass'
				// je spravne sestavena
				for(var i in out){
					assertEquals('### test dedeni z prvniho rozhrani a vsech predku [' + i + ']: ',out[i],xxx.getAttributes()[i]);
				}
				// zdedena matoda funguje?
				assertEquals('### test dedeni z druheho tozhrani',xxx.getNameAndTitle(),str);
				
				//access se zpravne zreplikoval ?
				assertEquals('test vytvoreni vlastnosti access pro get() :',xxx.get.access,"public getName")
				assertEquals('test vytvoreni vlastnosti access pro superCalling()',xxx.superCalling.access,"public sCl")
								
			}
				
		</script>
	</head>
	<body>
	
	</body>
</html>
